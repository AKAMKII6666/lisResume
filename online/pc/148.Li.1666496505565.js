(self.webpackChunkmr=self.webpackChunkmr||[]).push([[148],{8921:function(e,t,n){"use strict";n.r(t),n.d(t,{VRButton:function(){return r}});var d=n(9590),i=n(2998),o=n(7311),t=n(6499),c=n.n(t),r=function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,null,[{key:"createButton",value:function(r,e){var s=document.createElement("button");function a(){s.style.display="",s.style.cursor="auto",s.style.left="calc(50% - 75px)",s.style.width="150px",s.onmouseenter=null,s.onmouseleave=null,s.onclick=null,s.textContent="VR NOT SUPPORTED"}function t(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return s.id="VRButton",s.style.display="none",t(s),navigator.xr.isSessionSupported("immersive-vr").then(function(e){function t(e){return n.apply(this,arguments)}function n(){return(n=(0,d.Z)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.addEventListener("end",i),e.next=3,r.xr.setSession(t);case 3:s.textContent="EXIT VR",o=t;case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i(){o.removeEventListener("end",i),s.textContent="ENTER VR",o=null}var o;e?(o=null,s.style.display="",s.style.cursor="pointer",s.style.left="calc(50% - 50px)",s.style.width="100px",s.textContent="ENTER VR",s.onmouseenter=function(){s.style.opacity="1.0"},s.onmouseleave=function(){s.style.opacity="0.5"},s.onclick=function(){null===o?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking"]}).then(t):o.end()}):a()}),s;var n=document.createElement("a");return!1===window.isSecureContext?(n.href=document.location.href.replace(/^http:/,"https:"),n.innerHTML="WEBXR NEEDS HTTPS"):(n.href="https://immersiveweb.dev/",n.innerHTML="WEBXR NOT AVAILABLE"),n.style.left="calc(50% - 90px)",n.style.width="180px",n.style.textDecoration="none",t(n),n}}]),e}()},7084:function(e,t,n){"use strict";n.r(t),n.d(t,{APP:function(){return i}});var i={Player:function(){var e=this,h=new THREE.WebGLRenderer({antialias:!0});h.setPixelRatio(window.devicePixelRatio),h.outputEncoding=THREE.sRGBEncoding,h.shadowMap.type=THREE.PCFSoftShadowMap;var v,f,m=new THREE.ObjectLoader;this.camera=v,this.scene=f;var t,n,i,o=VRButton.createButton(h),w={},r=document.createElement("div");function y(e,t){for(var n=0,i=e.length;n<i;n++)e[n](t)}function s(){t=performance.now();try{void 0!==e.animateCall&&e.animateCall(),y(w.update,{time:t-n,delta:t-i})}catch(e){}h.render(f,v),i=t}function a(e){y(w.keydown,e)}function d(e){y(w.keyup,e)}function c(e){y(w.pointerdown,e)}function p(e){y(w.pointerup,e)}function u(e){y(w.pointermove,e)}r.appendChild(h.domElement),this.dom=r,this.width=500,this.height=500,this.load=function(e){var t=e.project;void 0!==t.vr&&(h.xr.enabled=t.vr),void 0!==t.shadows&&(h.shadowMap.enabled=t.shadows),void 0!==t.shadowType&&(h.shadowMap.type=THREE.PCFSoftShadowMap),void 0!==t.toneMapping&&(h.toneMapping=t.toneMapping),void 0!==t.toneMappingExposure&&(h.toneMappingExposure=t.toneMappingExposure),void 0!==t.physicallyCorrectLights&&(h.physicallyCorrectLights=t.physicallyCorrectLights),this.setScene(m.parse(e.scene)),this.setCamera(m.parse(e.camera));var n,i="player,renderer,scene,camera",o={};for(n in w={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]})i+=","+n,o[n]=n;var r,s=JSON.stringify(o).replace(/\"/g,"");for(r in e.scripts){var a=f.getObjectByProperty("uuid",r,!0);if(void 0!==a)for(var d=e.scripts[r],c=0;c<d.length;c++){var p,u=d[c],l=new Function(i,u.source+"\nreturn "+s+";").bind(a)(this,h,f,v);for(p in l)void 0!==l[p]&&void 0!==w[p]&&w[p].push(l[p].bind(a))}}y(w.init,arguments)},this.setCamera=function(e){(v=e).aspect=this.width/this.height,v.updateProjectionMatrix(),this.camera=v},this.setPrf=function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];if(("PointLight"===n.name||"SpotLight"===n.name)&&("low"===window.gCardLevel||"mid"===window.gCardLevel?(n.shadowMapWidth=0,n.shadowMapHeight=0):"high"===window.gCardLevel?(n.shadowMapWidth=1024,n.shadowMapHeight=1024):(n.shadowMapWidth=2048,n.shadowMapHeight=2048),void 0!==n.shadow&&void 0!==n.shadow.map))try{n.shadow.map.dispose(),n.shadow.map=null}catch(e){}}return e},this.setScene=function(e){e=this.setPrf(e),f=e,this.scene=e},this.setPixelRatio=function(e){h.setPixelRatio(e)},this.setSize=function(e,t){this.width=e,this.height=t,v&&(v.aspect=this.width/this.height,v.updateProjectionMatrix()),h&&("low"===window.gCardLevel&&h.setSize(e/8,t/8),"mid"===window.gCardLevel&&h.setSize(e/4,t/4),"high"===window.gCardLevel&&h.setSize(e/2,t/2),"ultra"===window.gCardLevel&&h.setSize(e,t))},this.play=function(){h.xr.enabled&&r.append(o),n=i=performance.now(),document.addEventListener("keydown",a),document.addEventListener("keyup",d),document.addEventListener("pointerdown",c),document.addEventListener("pointerup",p),document.addEventListener("pointermove",u),y(w.start,arguments),h.setAnimationLoop(s)},this.stop=function(){h.xr.enabled&&o.remove(),document.removeEventListener("keydown",a),document.removeEventListener("keyup",d),document.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",p),document.removeEventListener("pointermove",u),y(w.stop,arguments),h.setAnimationLoop(null)},this.render=function(e){y(w.update,{time:1e3*e,delta:0}),h.render(f,v)},this.dispose=function(){h.dispose(),f=v=void 0}}}}}]);